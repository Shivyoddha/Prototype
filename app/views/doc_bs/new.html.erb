<h2>Create New Document B</h2>

<%= form_with model: @doc_b, local: true do |form| %>
  <% if @doc_b.errors.any? %>
    <div class="alert alert-alert">
      <ul>
        <% @doc_b.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <% if @doc_b.eq_id.present? && @doc_b.name.present? %>
    <!-- Coming from Document A - show readonly fields -->
    <div class="form-group">
      <%= form.label :eq_id, "Equipment ID" %>
      <%= form.text_field :eq_id, value: @doc_b.eq_id, class: "form-control", readonly: true %>
    </div>

    <div class="form-group">
      <%= form.label :name, "Equipment Name" %>
      <%= form.text_field :name, value: @doc_b.name, class: "form-control", readonly: true %>
    </div>

    <div class="form-group">
      <%= form.label :cost, "Cost (in Rs.)" %>
      <div style="position: relative;">
        <span style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #666; font-weight: 500;">Rs.</span>
        <%= form.number_field :cost, value: @doc_b.cost, class: "form-control", readonly: true, style: "padding-left: 45px;" %>
      </div>
    </div>

    <div class="form-group">
      <%= form.label :head, "Head of Purchase" %>
      <%= form.text_field :head, value: @doc_b.head, class: "form-control", readonly: true %>
    </div>
  <% else %>
    <!-- Creating new Document B manually - show editable fields -->
    <div style="background: #f0f9ff; border-left: 4px solid #2563eb; padding: 12px; margin-bottom: 20px; border-radius: 4px;">
      <strong>Equipment ID:</strong> <span id="auto-eq-id" style="color: #2563eb; font-weight: 600;"><%= @next_eq_id %></span>
      <small style="display: block; color: #666; margin-top: 5px;">Equipment ID will be auto-generated</small>
    </div>

    <div class="form-group">
      <%= form.label :name, "Equipment Name" %>
      <%= form.text_field :name, placeholder: "e.g., Desktop, Printer", class: "form-control", required: true %>
    </div>

    <div class="form-group">
      <%= form.label :cost, "Cost (in Rs.)" %>
      <div style="position: relative;">
        <span style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #666; font-weight: 500;">Rs.</span>
        <%= form.number_field :cost, step: 0.01, class: "form-control", required: true, style: "padding-left: 45px;" %>
      </div>
    </div>

    <div class="form-group">
      <%= form.label :head, "Head of Purchase" %>
      <%= form.select :head, ["Project Fund", "Department Operating Cost", "Research Fund"], { prompt: "Select a purchase head" }, { class: "form-control", required: true } %>
    </div>
  <% end %>

  <div class="form-group">
    <%= form.label :proceedings, "Proceedings/Comments" %>
    <%= form.text_area :proceedings, class: "form-control", rows: 4, required: true %>
  </div>

  <div class="form-group">
    <%= form.label :u_remarks, "Your Remarks" %>
    <%= form.text_area :u_remarks, class: "form-control", rows: 3 %>
  </div>

  <%= form.submit "Create & Forward to P", class: "btn btn-primary" %>
  <%= link_to "Cancel", dashboard_path, class: "btn btn-secondary" %>
<% end %>

